<!-- =========================
     MOBILE TOP BAR
========================= -->
<div class="lg:hidden fixed top-0 left-0 right-0 z-50 bg-white border-b border-slate-200">
  <div class="h-14 px-3 flex items-center justify-between gap-2">
    <button type="button" onclick="openMobileSidebar()"
      class="inline-flex items-center gap-2 px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 font-extrabold text-slate-800">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
      </svg>
      Menu
    </button>

    <div class="flex items-center gap-2 min-w-0">
      <div class="w-9 h-9 rounded-xl bg-gradient-to-r from-orange-500 to-amber-400 text-white flex items-center justify-center font-extrabold shrink-0">
        S
      </div>
      <div class="min-w-0 leading-tight">
        <div class="text-sm font-extrabold text-slate-900 truncate">Dashboard</div>
        <div class="text-[11px] text-slate-500 font-semibold truncate">
          <%= (typeof cabang !== 'undefined' ? cabang : '') %>
        </div>
      </div>
    </div>

    <button type="button" onclick="toggleStats()"
      class="inline-flex items-center gap-2 px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 font-extrabold text-slate-800">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
      </svg>
      Filter
    </button>
  </div>
</div>

<!-- =========================
     MOBILE SIDEBAR DRAWER
========================= -->
<div id="mobileSidebarOverlay"
     class="lg:hidden fixed inset-0 bg-black/40 hidden z-50"
     onclick="closeMobileSidebar()"></div>

<aside id="mobileSidebar"
  class="lg:hidden fixed top-0 left-0 h-full w-[82%] max-w-[340px] bg-white z-[60]
         -translate-x-full transition-transform duration-300 border-r border-slate-200 shadow-2xl">
  <div class="h-14 px-4 flex items-center justify-between border-b border-slate-200">
    <div class="font-extrabold text-slate-900">Menu</div>
    <button type="button" onclick="closeMobileSidebar()"
      class="p-2 rounded-xl hover:bg-slate-100">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>
  </div>

  <nav class="p-4">
    <ul class="space-y-2">
      <li>
        <a href="/invoice/<%= (typeof cabang !== 'undefined' ? cabang : '') %>/stats"
           class="flex items-center gap-3 p-3 rounded-xl text-slate-800 hover:bg-orange-50 font-extrabold">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6m-6 0v-5m6 5v-5" />
          </svg>
          stats
        </a>
      </li>

      <li>
        <a href="/<%= (typeof cabang !== 'undefined' ? cabang : '') %>/pos"
           class="flex items-center gap-3 p-3 rounded-xl text-slate-800 hover:bg-orange-50 font-extrabold">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18h2" />
            <path d="M12 18h6" />
            <rect width="14" height="8" x="5" y="2" rx="2" />
            <rect width="20" height="8" x="2" y="14" rx="2" />
          </svg>
          purchases
        </a>
      </li>

      <li>
        <a href="/purchases"
           class="flex items-center gap-3 p-3 rounded-xl text-slate-800 hover:bg-orange-50 font-extrabold">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
          </svg>
          purchases

        </a>
      </li>

      <li>
        <a href="/<%= (typeof cabang !== 'undefined' ? cabang : '') %>/invoiceall"
           class="flex items-center gap-3 p-3 rounded-xl text-slate-800 hover:bg-orange-50 font-extrabold">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M9 7h6m0 10v-3m-6 3v-3m-6-4h12a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2zm9-3V5a2 2 0 00-2-2h-2a2 2 0 00-2 2v2m0 0a2 2 0 00-2 2v3h8V9a2 2 0 00-2-2z" />
          </svg>
          invoices
        </a>
      </li>
    </ul>
  </nav>
</aside>

<!-- =========================
     DESKTOP SIDEBAR
========================= -->
<aside
  id="sidebar"
  class="hidden lg:block w-16 transition-all duration-300 ease-in-out
         bg-white shadow-lg p-4 sticky top-0 h-screen overflow-hidden
         z-20 border-r border-slate-200"
  data-expanded="false"
  style="width: 4rem;">

  <div class="flex items-center justify-between mb-6">
    <button id="toggle-sidebar-btn"
      class="p-2 -mr-1 rounded-lg text-slate-700 hover:bg-slate-200 transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
        viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    <h2 class="text-xl font-bold whitespace-nowrap opacity-0 transition-opacity duration-200 text-orange-600">menu</h2>
  </div>

  <nav>
    <ul class="space-y-2">
      <li>
        <a href="/invoice/<%= (typeof cabang !== 'undefined' ? cabang : '') %>/stats"
          class="flex items-center p-2 rounded-lg text-slate-700 hover:bg-slate-100 hover:text-orange-600 font-medium group transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0"
            fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6m-6 0v-5m6 5v-5" />
          </svg>
          <span class="ml-3 whitespace-nowrap opacity-0 transition-opacity duration-200">stats</span>
        </a>
      </li>

      <li>
        <a href="/<%= (typeof cabang !== 'undefined' ? cabang : '') %>/pos"
          class="flex items-center p-2 rounded-lg text-slate-700 hover:bg-slate-100 hover:text-orange-600 font-medium group transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0"
            fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18h2" />
            <path d="M12 18h6" />
            <rect width="14" height="8" x="5" y="2" rx="2" />
            <rect width="20" height="8" x="2" y="14" rx="2" />
          </svg>
          <span class="ml-3 whitespace-nowrap opacity-0 transition-opacity duration-200">pos</span>
        </a>
      </li>

      <li>
        <a href="/purchases"
          class="flex items-center p-2 rounded-lg text-slate-700 hover:bg-slate-100 hover:text-orange-600 font-medium group transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0"
            fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
          </svg>
          <span class="ml-3 whitespace-nowrap opacity-0 transition-opacity duration-200">purchases</span>
        </a>
      </li>

      <li>
        <a href="/<%= (typeof cabang !== 'undefined' ? cabang : '') %>/invoiceall"
          class="flex items-center p-2 rounded-lg text-slate-700 hover:bg-slate-100 hover:text-orange-600 font-medium group transition-colors">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0"
            fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
              stroke-width="2"
              d="M9 7h6m0 10v-3m-6 3v-3m-6-4h12a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2zm9-3V5a2 2 0 00-2-2h-2a2 2 0 00-2 2v2m0 0a2 2 0 00-2 2v3h8V9a2 2 0 00-2-2z" />
          </svg>
          <span class="ml-3 whitespace-nowrap opacity-0 transition-opacity duration-200">invoices</span>
        </a>
      </li>
    </ul>
  </nav>
</aside>

<script>
  function openMobileSidebar() {
    const drawer = document.getElementById('mobileSidebar');
    const overlay = document.getElementById('mobileSidebarOverlay');
    overlay?.classList.remove('hidden');
    drawer?.classList.remove('-translate-x-full');
  }

  function closeMobileSidebar() {
    const drawer = document.getElementById('mobileSidebar');
    const overlay = document.getElementById('mobileSidebarOverlay');
    drawer?.classList.add('-translate-x-full');
    overlay?.classList.add('hidden');
  }

  // desktop expand/collapse
  (function(){
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('toggle-sidebar-btn');
    if (!sidebar || !toggleBtn) return;

    const linksText = sidebar.querySelectorAll('span');
    const titleText = sidebar.querySelector('h2');

    function toggleSidebar() {
      const isExpanded = sidebar.getAttribute('data-expanded') === 'true';

      if (!isExpanded) {
        sidebar.classList.remove('w-16');
        sidebar.classList.add('w-60');
        sidebar.setAttribute('data-expanded', 'true');
        sidebar.style.width = '15rem';

        setTimeout(() => {
          linksText.forEach(span => { span.classList.remove('opacity-0'); span.classList.add('opacity-100'); });
          titleText.classList.remove('opacity-0'); titleText.classList.add('opacity-100');
        }, 100);
      } else {
        linksText.forEach(span => { span.classList.remove('opacity-100'); span.classList.add('opacity-0'); });
        titleText.classList.remove('opacity-100'); titleText.classList.add('opacity-0');

        setTimeout(() => {
          sidebar.classList.remove('w-60');
          sidebar.classList.add('w-16');
          sidebar.setAttribute('data-expanded', 'false');
          sidebar.style.width = '4rem';
        }, 200);
      }
    }

    toggleBtn.addEventListener('click', toggleSidebar);
  })();
</script>
